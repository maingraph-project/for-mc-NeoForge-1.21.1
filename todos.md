# 节点注册系统改进建议 (按逻辑顺序排列)

## 第一阶段：基础设施与规范 (重构基础)
- [ ] **提升线程安全性**
    - 将 [NodeRegistry.java] 和 [NodeLogicRegistry.java] 的底层 `HashMap` 替换为 `ConcurrentHashMap`。
    - **因果关系**：确保在后续引入多线程初始化或事件驱动注册时，底层存储不会崩溃。
- [ ] **引入命名空间机制**
    - 自动为节点 ID 添加 `modid:` 前缀（例如 `mgmc:on_mgrun`）。
    - **因果关系**：确立 ID 契约。在开放外部 API 之前必须解决，否则后期更改 ID 格式会导致蓝图存档不兼容。

## 第二阶段：初始化流程重构 (控制力与解耦)
- [ ] **消除静态初始化风险**
    - 移除 [NodeRegistry.java] 中的 `static {}` 块。
    - 改用显式的初始化流程（由 Mod 构造函数或 `FMLCommonSetupEvent` 触发）。
    - **因果关系**：夺回初始化时机的控制权，这是实现“注册事件”的前提。
- [ ] **逻辑与元数据解耦**
    - 优化架构，允许客户端仅加载 [NodeDefinition]（元数据）而不必加载执行逻辑 `NodeHandler`。
    - **因果关系**：减少客户端内存占用，并为未来纯客户端的编辑器功能打下基础。

## 第三阶段：外部接入 (API 开放)
- [ ] **实现自定义注册事件**
    - 设计专用的 `RegisterNodesEvent`，允许其他模组通过订阅事件来注册节点。
    - **因果关系**：基于前两个阶段的稳定基础，正式向外部提供符合 NeoForge 规范的扩展接口。
